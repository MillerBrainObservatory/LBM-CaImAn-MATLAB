function [xx,yy] = musoid(tt,varargin)
% musoid stimulus function

%% parse inputs
inputs = scanimage.mroi.util.parseInputs(varargin);

if ~isfield(inputs,'sex') || isempty(inputs.sex)
    inputs.sex = 'male';
end

%% generate output

switch inputs.sex
    case 'male'
        % source: http://www.wolframalpha.com/input/?i=mouse+function
        tt = tt ./ tt(end); %normalize tt
        phi = (2 * pi) .* tt;
        
        xx = -119/9.*sin(1/10-25.*phi)-945/43.*sin(5/11-23.*phi)-501/8.*sin(1/47-10.*phi)-801/20.*sin(13/10-8.*phi)-607/10.*sin(7/10-7.*phi)-1975/9.*sin(3/7-2.*phi)+4655/8.*sin(phi+29/10)+773/7.*sin(3.*phi+76/17)+1138/9.*sin(4.*phi+1/3)+619/4.*sin(5.*phi+5/8)+3355/26.*sin(6.*phi+13/10)+595/9.*sin(9.*phi+28/11)+905/9.*sin(11.*phi+40/11)+149/10.*sin(12.*phi+7/11)+153/5.*sin(13.*phi+2)+127/8.*sin(14.*phi+13/6)+225/8.*sin(15.*phi+3/2)+49/4.*sin(16.*phi+25/7)+133/9.*sin(17.*phi+15/8)+301/15.*sin(18.*phi+31/9)+232/7.*sin(19.*phi+11/7)+438/19.*sin(20.*phi+10/7)+67/3.*sin(21.*phi+19/10)+114/11.*sin(22.*phi+38/37)+153/11.*sin(24.*phi+10/9)+153/8.*sin(26.*phi+11/12)+443/34.*sin(27.*phi+23/14)+39/7.*sin(28.*phi+45/11)+32/3.*sin(29.*phi+4/11)+110/13.*sin(30.*phi+3/8)+41/7.*sin(31.*phi+70/23)+39/7.*sin(32.*phi+13/9);
        yy = -89/19.*sin(6/7-30.*phi)-89/8.*sin(2/3-29.*phi)-687/49.*sin(4/9-24.*phi)-294/11.*sin(11/8-20.*phi)-135/4.*sin(10/11-17.*phi)-71/7.*sin(1/6-15.*phi)-226/5.*sin(3/8-14.*phi)-295/8.*sin(1/8-11.*phi)-220/7.*sin(17/16-10.*phi)-708/7.*sin(1/6-9.*phi)-2017/8.*sin(5/4-2.*phi)-1240/3.*sin(11/10-phi)+104/15.*sin(18.*phi)+2216/7.*sin(3.*phi+39/11)+601/3.*sin(4.*phi+18/11)+468/11.*sin(5.*phi+34/11)+127/7.*sin(6.*phi+27/7)+457/8.*sin(7.*phi+25/6)+201/4.*sin(8.*phi+23/7)+71/3.*sin(12.*phi+4/7)+340/7.*sin(13.*phi+39/11)+216/7.*sin(16.*phi+27/13)+31/5.*sin(19.*phi+24/25)+8/5.*sin(21.*phi+1/7)+217/11.*sin(22.*phi+23/14)+34/3.*sin(23.*phi+19/8)+157/9.*sin(25.*phi+3/10)+69/4.*sin(26.*phi+2/3)+29/5.*sin(27.*phi+15/7)+58/7.*sin(28.*phi+29/8)+95/11.*sin(31.*phi+19/8)+34/9.*sin(32.*phi+40/9);
        
        % scale output to fill the interval [-1, 1]
        xx =  xx / 1000;
        yy = -yy / 1000;
    case 'female'
        % source: http://www.wolframalpha.com/input/?i=minnie+mouse+curve
        tt = tt ./ tt(end); %normalize tt
        phi = (88.*pi) .* tt;
        xx = ((-24/5.*sin(2/3-6.*phi)-61/12.*sin(3/2-4.*phi)-1157/6.*sin(22/15-phi)+45/8.*sin(8.*phi)+1197/52.*sin(2.*phi+19/5)+22/3.*sin(3.*phi+33/7)+139/14.*sin(5.*phi+11/4)+33/4.*sin(7.*phi+82/27)+37/7.*sin(9.*phi+58/19)-2438/3).*heaviside(87.*pi-phi).*heaviside(phi-83.*pi)+(-292/7.*sin(15/11-4.*phi)+2871/8.*sin(phi+29/14)+413/5.*sin(2.*phi+14/3)+159/5.*sin(3.*phi+23/5)+37/4.*sin(5.*phi+50/11)+11.*sin(6.*phi+9/2)+1411/6).*heaviside(83.*pi-phi).*heaviside(phi-79.*pi)+(-1/16.*sin(1/21-55.*phi)-1/13.*sin(1/12-45.*phi)-1/9.*sin(1/7-35.*phi)-1/11.*sin(1/10-29.*phi)-1/7.*sin(2/7-25.*phi)-1/10.*sin(1/4-19.*phi)-2/7.*sin(7/11-15.*phi)-4/7.*sin(1/26-11.*phi)-27/14.*sin(9/7-5.*phi)+1/7.*sin(31.*phi)+1/13.*sin(39.*phi)+1/10.*sin(41.*phi)+1/16.*sin(49.*phi)+1/13.*sin(51.*phi)+476/9.*sin(phi+1/32)+28/5.*sin(2.*phi+24/7)+101/20.*sin(3.*phi+11/5)+5/6.*sin(4.*phi+27/7)+14/15.*sin(6.*phi+29/9)+15/11.*sin(7.*phi+7/10)+3/8.*sin(8.*phi+13/3)+1/12.*sin(9.*phi+82/27)+1/2.*sin(10.*phi+13/5)+3/7.*sin(12.*phi+39/11)+2/9.*sin(13.*phi+9/7)+1/6.*sin(14.*phi+16/5)+2/7.*sin(16.*phi+23/7)+2/7.*sin(17.*phi+2/5)+1/7.*sin(18.*phi+29/8)+1/6.*sin(20.*phi+32/11)+1/4.*sin(21.*phi+1/40)+1/6.*sin(22.*phi+17/5)+1/8.*sin(23.*phi+7/13)+1/9.*sin(24.*phi+31/10)+1/6.*sin(26.*phi+19/6)+1/6.*sin(27.*phi+2/7)+1/9.*sin(28.*phi+24/7)+1/8.*sin(30.*phi+3)+1/8.*sin(32.*phi+10/3)+1/11.*sin(33.*phi+1/4)+1/12.*sin(34.*phi+22/7)+1/9.*sin(36.*phi+22/7)+1/9.*sin(37.*phi+1/5)+1/12.*sin(38.*phi+10/3)+1/11.*sin(40.*phi+79/26)+1/11.*sin(42.*phi+23/7)+1/13.*sin(43.*phi+1/6)+1/14.*sin(44.*phi+19/6)+1/12.*sin(46.*phi+19/6)+1/12.*sin(47.*phi+1/7)+1/15.*sin(48.*phi+23/7)+1/14.*sin(50.*phi+37/12)+1/14.*sin(52.*phi+13/4)+1/16.*sin(53.*phi+1/7)+1/17.*sin(54.*phi+19/6)+1/15.*sin(56.*phi+19/6)+1/15.*sin(57.*phi+1/10)+1/17.*sin(58.*phi+13/4)+1/18.*sin(59.*phi+1/40)+1/17.*sin(60.*phi+28/9)+3817/9).*heaviside(79.*pi-phi).*heaviside(phi-75.*pi)+(-7/2.*sin(9/7-9.*phi)-7/6.*sin(7/8-7.*phi)+1147/9.*sin(phi+5/9)+259/3.*sin(2.*phi+23/7)+45/2.*sin(3.*phi+19/7)+153/7.*sin(4.*phi+41/20)+14/9.*sin(5.*phi+2/9)+67/9.*sin(6.*phi+22/7)+12/5.*sin(8.*phi+23/9)+21/5.*sin(10.*phi+31/9)-301/3).*heaviside(75.*pi-phi).*heaviside(phi-71.*pi)+(-5/4.*sin(1/4-10.*phi)-14/9.*sin(1/2-7.*phi)-2.*sin(17/18-4.*phi)-1359/8.*sin(4/11-phi)+65/9.*sin(2.*phi+3/5)+113/7.*sin(3.*phi+37/19)+78/11.*sin(5.*phi+37/10)+75/37.*sin(6.*phi+1/5)+3/7.*sin(8.*phi+1/2)+11/5.*sin(9.*phi+23/10)-1502/5).*heaviside(71.*pi-phi).*heaviside(phi-67.*pi)+(-35/34.*sin(7/8-10.*phi)-36/11.*sin(8/9-5.*phi)+1355/9.*sin(phi+32/13)+139/28.*sin(2.*phi+8/7)+221/20.*sin(3.*phi+33/8)+31/10.*sin(4.*phi+7/13)+13/7.*sin(6.*phi+11/7)+33/17.*sin(7.*phi+6/5)+6/5.*sin(8.*phi+149/37)+7/6.*sin(9.*phi+23/9)+5315/8).*heaviside(67.*pi-phi).*heaviside(phi-63.*pi)+(-11/7.*sin(2/3-9.*phi)-35/6.*sin(5/6-7.*phi)-117/7.*sin(44/43-5.*phi)+957/8.*sin(phi+1/4)+635/8.*sin(2.*phi+1)+242/9.*sin(3.*phi+32/7)+83/6.*sin(4.*phi+12/7)+5/2.*sin(6.*phi+4/3)+6.*sin(8.*phi+3)+3/5.*sin(10.*phi+23/8)-1568/5).*heaviside(63.*pi-phi).*heaviside(phi-59.*pi)+(-54/7.*sin(2/9-10.*phi)-66/5.*sin(5/8-8.*phi)-73/8.*sin(1/2-6.*phi)-1021/20.*sin(1/25-4.*phi)-285/8.*sin(14/9-3.*phi)-185/2.*sin(14/11-2.*phi)-1951/7.*sin(3/4-phi)+245/9.*sin(5.*phi+26/9)+7.*sin(7.*phi+6/11)+93/8.*sin(9.*phi+15/7)-442/5).*heaviside(59.*pi-phi).*heaviside(phi-55.*pi)+(-4/9.*sin(1/5-9.*phi)-23/6.*sin(5/6-3.*phi)-6/5.*sin(1/5-2.*phi)+566/9.*sin(phi+2/7)+24/7.*sin(4.*phi+29/9)+17/11.*sin(5.*phi+32/9)+3/4.*sin(6.*phi+11/9)+6/5.*sin(7.*phi+5/9)+2/7.*sin(8.*phi+35/8)+4/5.*sin(10.*phi+31/9)+1249/8).*heaviside(55.*pi-phi).*heaviside(phi-51.*pi)+(-3/2.*sin(8/7-6.*phi)-175/16.*sin(1/3-2.*phi)+453/5.*sin(phi+3/8)+34/9.*sin(3.*phi+23/11)+9/2.*sin(4.*phi+25/8)+11/10.*sin(5.*phi+15/4)+9/7.*sin(7.*phi+1/9)+15/14.*sin(8.*phi+13/5)+1/4.*sin(9.*phi+13/7)+2/3.*sin(10.*phi+16/5)+5149/5).*heaviside(51.*pi-phi).*heaviside(phi-47.*pi)+(-11/10.*sin(3/8-9.*phi)-93/5.*sin(1/3-3.*phi)-2022/13.*sin(19/18-phi)+128/11.*sin(2.*phi+19/7)+33/7.*sin(4.*phi+41/14)+51/8.*sin(5.*phi+1/3)+18/5.*sin(6.*phi+34/11)+11/6.*sin(7.*phi+3/5)+11/5.*sin(8.*phi+27/8)+7/6.*sin(10.*phi+13/4)+1269/5).*heaviside(47.*pi-phi).*heaviside(phi-43.*pi)+(-21/2.*sin(7/9-6.*phi)-18.*sin(6/5-4.*phi)+3377/10.*sin(phi+1)+679/11.*sin(2.*phi+5/6)+329/22.*sin(3.*phi+9/5)+111/5.*sin(5.*phi+15/7)+143/24.*sin(7.*phi+5/2)+18/5.*sin(8.*phi+9/7)+13/8.*sin(9.*phi+9/2)+sin(10.*phi+9/7)+6447/13).*heaviside(43.*pi-phi).*heaviside(phi-39.*pi)+(-7/9.*sin(15/14-7.*phi)-171/10.*sin(3/4-3.*phi)-73/4.*sin(9/7-2.*phi)-623/3.*sin(3/5-phi)+74/11.*sin(4.*phi+9/5)+26/5.*sin(5.*phi+1/28)+18/5.*sin(6.*phi+17/11)+21/22.*sin(8.*phi+23/10)+8/7.*sin(9.*phi+21/20)+2.*sin(10.*phi+65/22)+518/5).*heaviside(39.*pi-phi).*heaviside(phi-35.*pi)+(-235/9.*sin(1/6-3.*phi)+31/3.*sin(5.*phi)+2727/7.*sin(phi+13/10)+735/13.*sin(2.*phi+17/10)+89/5.*sin(4.*phi+49/25)+29/9.*sin(6.*phi+7/2)+23/11.*sin(7.*phi+13/10)+10/7.*sin(8.*phi+18/5)+23/10.*sin(9.*phi+20/9)+1/5.*sin(10.*phi+25/9)-2409/8).*heaviside(35.*pi-phi).*heaviside(phi-31.*pi)+(-8/3.*sin(4/5-9.*phi)+1833/4.*sin(phi+3/2)+865/11.*sin(2.*phi+26/7)+49.*sin(3.*phi+25/7)+487/18.*sin(4.*phi+17/6)+83/9.*sin(5.*phi+19/10)+59/7.*sin(6.*phi+7/11)+38/9.*sin(7.*phi+1/6)+39/10.*sin(8.*phi+1/5)+sin(10.*phi+33/7)+2435/4).*heaviside(31.*pi-phi).*heaviside(phi-27.*pi)+(-14.*sin(4/7-18.*phi)-47/6.*sin(15/14-14.*phi)-49/2.*sin(9/10-12.*phi)-147/4.*sin(2/7-9.*phi)-768/5.*sin(3/4-3.*phi)-3355/8.*sin(1/9-phi)+1553/9.*sin(2.*phi+5/4)+355/8.*sin(4.*phi+10/7)+43/7.*sin(5.*phi+35/8)+2653/51.*sin(6.*phi+15/7)+313/6.*sin(7.*phi+47/16)+103/2.*sin(8.*phi+25/6)+18.*sin(10.*phi+3/2)+59/10.*sin(11.*phi+2)+119/6.*sin(13.*phi+20/7)+22.*sin(15.*phi+17/4)+179/10.*sin(16.*phi+5/2)+31/4.*sin(17.*phi+8/7)+57/4.*sin(19.*phi+117/29)+16/5.*sin(20.*phi+23/9)+17/7.*sin(21.*phi+10/7)-7341/11).*heaviside(27.*pi-phi).*heaviside(phi-23.*pi)+(-71/4.*sin(5/6-9.*phi)-846/11.*sin(3/4-3.*phi)-493/2.*sin(5/6-phi)+393/10.*sin(2.*phi+11/3)+302/7.*sin(4.*phi+9/5)+68/3.*sin(5.*phi+25/7)+528/23.*sin(6.*phi+3)+384/11.*sin(7.*phi+19/7)+61/4.*sin(8.*phi+39/10)+53/7.*sin(10.*phi+6/5)+25/3.*sin(11.*phi+23/7)+133/12.*sin(12.*phi+21/5)+23/4.*sin(13.*phi+1/14)+65/9.*sin(14.*phi+5/11)+10943/16).*heaviside(23.*pi-phi).*heaviside(phi-19.*pi)+(-25/9.*sin(5/4-13.*phi)-44/15.*sin(16/15-12.*phi)-107/9.*sin(16/11-8.*phi)-80/7.*sin(1/2-7.*phi)-103/7.*sin(1/4-6.*phi)+1544/3.*sin(phi+3/7)+3706/57.*sin(2.*phi+9/7)+404/5.*sin(3.*phi+13/3)+215/12.*sin(4.*phi+12/5)+101/10.*sin(5.*phi+1/18)+4.*sin(9.*phi+38/9)+16/7.*sin(10.*phi+5/7)+10/9.*sin(11.*phi+7/10)+14/5.*sin(14.*phi+16/5)+18/5.*sin(15.*phi+43/22)-10175/24).*heaviside(19.*pi-phi).*heaviside(phi-15.*pi)+(-33/4.*sin(1/6-24.*phi)-93/8.*sin(2/5-20.*phi)-8.*sin(3/5-18.*phi)-408/37.*sin(4/5-16.*phi)-49/5.*sin(14/15-14.*phi)-19/2.*sin(13/9-12.*phi)-131/7.*sin(1/6-10.*phi)-555/11.*sin(10/7-6.*phi)+1446/7.*sin(phi+21/5)+2419/8.*sin(2.*phi+61/30)+321/2.*sin(3.*phi+45/23)+329/2.*sin(4.*phi+1/2)+1191/10.*sin(5.*phi+19/7)+400/7.*sin(7.*phi+81/20)+284/9.*sin(8.*phi+3/7)+236/7.*sin(9.*phi+25/9)+100/7.*sin(11.*phi+26/7)+26/7.*sin(13.*phi+43/11)+59/7.*sin(15.*phi+15/8)+53/6.*sin(17.*phi+7/5)+34/9.*sin(19.*phi+13/5)+103/11.*sin(21.*phi+13/8)+83/9.*sin(22.*phi+1/7)+19/5.*sin(23.*phi+13/5)-4462/7).*heaviside(15.*pi-phi).*heaviside(phi-11.*pi)+(-73/7.*sin(2/3-12.*phi)-211/9.*sin(4/9-11.*phi)-48/7.*sin(11/12-8.*phi)-1189/36.*sin(3/2-5.*phi)-581/9.*sin(16/11-3.*phi)+878/13.*sin(phi+39/10)+557/6.*sin(2.*phi+9/7)+85/2.*sin(4.*phi+8/5)+73/5.*sin(6.*phi+11/7)+38/5.*sin(7.*phi+55/18)+181/13.*sin(9.*phi+19/5)+87/11.*sin(10.*phi+1/4)+19/3.*sin(13.*phi+1/8)+109/10.*sin(14.*phi+1)+83).*heaviside(11.*pi-phi).*heaviside(phi-7.*pi)+(-57/7.*sin(3/5-13.*phi)-193/8.*sin(7/6-5.*phi)+28/5.*sin(10.*phi)+302/5.*sin(phi+15/4)+991/18.*sin(2.*phi+11/7)+147/4.*sin(3.*phi+47/10)+207/7.*sin(4.*phi+11/6)+10.*sin(6.*phi+23/7)+187/10.*sin(7.*phi+23/7)+47/5.*sin(8.*phi+13/7)+7.*sin(9.*phi+32/7)+29/8.*sin(11.*phi+11/5)+24/5.*sin(12.*phi+29/7)+2914/11).*heaviside(7.*pi-phi).*heaviside(phi-3.*pi)+(-54/7.*sin(1-39.*phi)-45/7.*sin(15/14-35.*phi)-71/7.*sin(7/9-34.*phi)-19/10.*sin(10/7-30.*phi)-37/6.*sin(1/5-29.*phi)-31/5.*sin(1-28.*phi)-175/16.*sin(8/7-27.*phi)-74/5.*sin(1/13-23.*phi)-35/2.*sin(5/9-19.*phi)-614/15.*sin(1/2-9.*phi)-579/7.*sin(4/5-5.*phi)+1285/7.*sin(phi+6/5)+1865/11.*sin(2.*phi+39/10)+439/3.*sin(3.*phi+2/7)+834/7.*sin(4.*phi+29/10)+125/3.*sin(6.*phi+2)+69/14.*sin(7.*phi+3/4)+357/13.*sin(8.*phi+17/6)+255/7.*sin(10.*phi+25/13)+301/8.*sin(11.*phi+43/10)+287/10.*sin(12.*phi+4/7)+205/6.*sin(13.*phi+16/5)+82/7.*sin(14.*phi+2/3)+133/6.*sin(15.*phi+19/6)+132/7.*sin(16.*phi+40/9)+227/10.*sin(17.*phi+16/7)+119/10.*sin(18.*phi+17/10)+17.*sin(20.*phi+13/8)+281/10.*sin(21.*phi+19/13)+345/8.*sin(22.*phi+1)+181/36.*sin(24.*phi+25/7)+5.*sin(25.*phi+20/9)+89/6.*sin(26.*phi+75/19)+124/25.*sin(31.*phi+19/10)+40/3.*sin(32.*phi+1/13)+25/4.*sin(33.*phi+24/7)+107/12.*sin(36.*phi+7/9)+74/7.*sin(37.*phi+31/16)+35/4.*sin(38.*phi+9/4)+18/5.*sin(40.*phi+1/10)+19/7.*sin(41.*phi+5/6)+22/9.*sin(42.*phi+53/18)+110/13.*sin(43.*phi+32/11)+10/3.*sin(44.*phi+3/4)+3764/7).*heaviside(3.*pi-phi).*heaviside(phi+pi)).*heaviside(sqrt(sign(sin(phi/2))));
        yy = ((-113/38.*sin(2/7-5.*phi)+411/4.*sin(phi+21/8)+514/13.*sin(2.*phi+27/7)+131/8.*sin(3.*phi+68/15)+23/7.*sin(4.*phi+14/5)+25/4.*sin(6.*phi+18/7)+23/15.*sin(7.*phi+1/6)+35/9.*sin(8.*phi+49/16)+26/11.*sin(9.*phi+3/7)+4757/5).*heaviside(87.*pi-phi).*heaviside(phi-83.*pi)+(1474/7.*sin(phi+2/7)+470/9.*sin(2.*phi+181/45)+291/8.*sin(3.*phi+17/6)+101/4.*sin(4.*phi+33/8)+244/27.*sin(5.*phi+30/7)+47/4.*sin(6.*phi+27/7)-7248/7).*heaviside(83.*pi-phi).*heaviside(phi-79.*pi)+(-1/7.*sin(1/34-38.*phi)-1/6.*sin(1/21-28.*phi)-1/4.*sin(1/15-18.*phi)-2/3.*sin(2/7-8.*phi)-19/3.*sin(1/6-2.*phi)-512/9.*sin(3/4-phi)+1/4.*sin(24.*phi)+1/6.*sin(34.*phi)+1/8.*sin(44.*phi)+1/9.*sin(48.*phi)+1/10.*sin(54.*phi)+1/11.*sin(58.*phi)+29/6.*sin(3.*phi+13/7)+14/5.*sin(4.*phi+7/11)+2.*sin(5.*phi+18/5)+2/5.*sin(6.*phi+1)+3/7.*sin(7.*phi+27/8)+4/5.*sin(9.*phi+33/10)+2/3.*sin(10.*phi+1/6)+1/3.*sin(11.*phi+34/9)+3/8.*sin(12.*phi+1/9)+3/8.*sin(13.*phi+17/6)+3/7.*sin(14.*phi+1/11)+2/5.*sin(15.*phi+27/8)+2/7.*sin(16.*phi+2/7)+2/9.*sin(17.*phi+19/6)+1/3.*sin(19.*phi+25/8)+2/7.*sin(20.*phi+1/6)+2/9.*sin(21.*phi+24/7)+1/5.*sin(22.*phi+1/26)+1/5.*sin(23.*phi+76/25)+2/9.*sin(25.*phi+23/7)+1/5.*sin(26.*phi+1/6)+1/6.*sin(27.*phi+16/5)+1/5.*sin(29.*phi+25/8)+1/6.*sin(30.*phi+1/9)+1/6.*sin(31.*phi+33/10)+1/7.*sin(32.*phi+1/18)+1/7.*sin(33.*phi+34/11)+1/6.*sin(35.*phi+13/4)+1/7.*sin(36.*phi+1/7)+1/8.*sin(37.*phi+16/5)+1/7.*sin(39.*phi+22/7)+1/7.*sin(40.*phi+1/13)+1/8.*sin(41.*phi+13/4)+1/8.*sin(42.*phi+1/21)+1/8.*sin(43.*phi+25/8)+1/8.*sin(45.*phi+16/5)+1/9.*sin(46.*phi+1/10)+1/9.*sin(47.*phi+16/5)+1/9.*sin(49.*phi+22/7)+1/9.*sin(50.*phi+1/16)+1/10.*sin(51.*phi+29/9)+1/10.*sin(52.*phi+1/23)+1/10.*sin(53.*phi+22/7)+1/10.*sin(55.*phi+16/5)+1/11.*sin(56.*phi+1/13)+1/11.*sin(57.*phi+16/5)+1/11.*sin(59.*phi+19/6)+1/11.*sin(60.*phi+1/20)-1125/7).*heaviside(79.*pi-phi).*heaviside(phi-75.*pi)+(-16/5.*sin(2/7-9.*phi)-17/2.*sin(4/7-5.*phi)+523/4.*sin(phi+1/11)+385/8.*sin(2.*phi+8/7)+391/11.*sin(3.*phi+31/7)+25/4.*sin(4.*phi+21/8)+27/2.*sin(6.*phi+58/19)+8/5.*sin(7.*phi+1)+27/8.*sin(8.*phi+12/5)+16/5.*sin(10.*phi+19/7)-3871/5).*heaviside(75.*pi-phi).*heaviside(phi-71.*pi)+(-4/9.*sin(4/5-8.*phi)-13/9.*sin(4/9-7.*phi)+600/7.*sin(phi+14/3)+82/7.*sin(2.*phi+24/7)+71/6.*sin(3.*phi+14/9)+41/9.*sin(4.*phi+13/5)+23/8.*sin(5.*phi+27/10)+8/7.*sin(6.*phi+23/7)+39/38.*sin(9.*phi+8/15)+7/11.*sin(10.*phi+23/7)-8587/13).*heaviside(71.*pi-phi).*heaviside(phi-67.*pi)+(-3/7.*sin(6/5-10.*phi)-1/3.*sin(7/5-8.*phi)-673/6.*sin(8/7-phi)+61/7.*sin(2.*phi+11/9)+163/9.*sin(3.*phi+3/8)+13/4.*sin(4.*phi+5/11)+40/7.*sin(5.*phi+13/7)+18/11.*sin(6.*phi+6/7)+26/7.*sin(7.*phi+17/6)+27/14.*sin(9.*phi+4)-57941/37).*heaviside(67.*pi-phi).*heaviside(phi-63.*pi)+(-13/6.*sin(10/7-10.*phi)-11/6.*sin(2/3-7.*phi)-77/6.*sin(19/18-5.*phi)-211/4.*sin(1/10-2.*phi)-1629/7.*sin(3/10-phi)+304/7.*sin(3.*phi+31/10)+155/8.*sin(4.*phi+15/7)+13/7.*sin(6.*phi+6/7)+57/7.*sin(8.*phi+7/3)+sin(9.*phi+2/7)-16507/11).*heaviside(63.*pi-phi).*heaviside(phi-59.*pi)+(-119/4.*sin(3/7-5.*phi)+3009/8.*sin(phi+13/3)+323/6.*sin(2.*phi+17/4)+109/5.*sin(3.*phi+7/4)+175/9.*sin(4.*phi+49/12)+324/25.*sin(6.*phi+97/32)+31/3.*sin(7.*phi+1/4)+69/4.*sin(8.*phi+47/12)+29/2.*sin(9.*phi+5/6)+39/5.*sin(10.*phi+4)-20286/13).*heaviside(59.*pi-phi).*heaviside(phi-55.*pi)+(-11/7.*sin(7/13-7.*phi)+233/5.*sin(phi+31/7)+26/7.*sin(2.*phi+10/7)+43/8.*sin(3.*phi+11/6)+15/7.*sin(4.*phi+11/3)+12/7.*sin(5.*phi+1/5)+11/8.*sin(6.*phi+29/8)+sin(8.*phi+28/11)+1/6.*sin(9.*phi+1/8)+4/11.*sin(10.*phi+27/11)-11029/8).*heaviside(55.*pi-phi).*heaviside(phi-51.*pi)+(-79/20.*sin(1/24-5.*phi)-547/4.*sin(4/5-phi)+177/11.*sin(2.*phi+13/6)+83/9.*sin(3.*phi+3/7)+77/8.*sin(4.*phi+25/8)+29/10.*sin(6.*phi+33/8)+33/10.*sin(7.*phi+3/8)+21/20.*sin(8.*phi+32/11)+18/19.*sin(9.*phi+31/30)+15/11.*sin(10.*phi+10/3)-1389/2).*heaviside(51.*pi-phi).*heaviside(phi-47.*pi)+(-8/7.*sin(2/3-9.*phi)-15/14.*sin(2/7-7.*phi)-64/13.*sin(11/12-5.*phi)-20/9.*sin(7/15-4.*phi)+355/6.*sin(phi+11/4)+111/7.*sin(2.*phi+23/7)+57/4.*sin(3.*phi+31/7)+23/9.*sin(6.*phi+11/6)+18/11.*sin(8.*phi+27/10)+5/6.*sin(10.*phi+16/5)-5519/7).*heaviside(47.*pi-phi).*heaviside(phi-43.*pi)+(-35/9.*sin(1/2-9.*phi)-30/7.*sin(9/8-7.*phi)-282/7.*sin(3/5-3.*phi)-1821/4.*sin(44/43-phi)+271/10.*sin(2.*phi+1)+68/5.*sin(4.*phi+18/5)+33/7.*sin(5.*phi+3/10)+2.*sin(6.*phi+1/2)+25/6.*sin(8.*phi+17/8)+12/5.*sin(10.*phi+31/9)-13859/8).*heaviside(43.*pi-phi).*heaviside(phi-39.*pi)+(1710/7.*sin(phi+30/7)+121/6.*sin(2.*phi+22/15)+51/4.*sin(3.*phi+17/4)+63/5.*sin(4.*phi+1/17)+3/5.*sin(5.*phi+22/5)+1/2.*sin(6.*phi+25/24)+13/6.*sin(7.*phi+129/32)+13/6.*sin(8.*phi+5/11)+7/15.*sin(9.*phi+65/32)+10/7.*sin(10.*phi+11/8)-6599/15).*heaviside(39.*pi-phi).*heaviside(phi-35.*pi)+(-199/18.*sin(5/9-5.*phi)-533/9.*sin(4/5-3.*phi)-517/3.*sin(7/10-phi)+642/7.*sin(2.*phi+9/7)+63/10.*sin(4.*phi+13/3)+253/28.*sin(6.*phi+22/5)+17/9.*sin(7.*phi+5/4)+29/8.*sin(8.*phi+13/3)+12/7.*sin(9.*phi+19/7)+5/4.*sin(10.*phi+9/2)-14121/7).*heaviside(35.*pi-phi).*heaviside(phi-31.*pi)+(-17/3.*sin(19/13-9.*phi)-45/2.*sin(4/3-5.*phi)-846/11.*sin(5/9-3.*phi)-1568/9.*sin(1/21-phi)+2273/9.*sin(2.*phi+7/6)+99/7.*sin(4.*phi+7/6)+28/5.*sin(6.*phi+11/4)+67/5.*sin(7.*phi+33/7)+8.*sin(8.*phi+19/7)+84/11.*sin(10.*phi+5/2)-12427/6).*heaviside(31.*pi-phi).*heaviside(phi-27.*pi)+(-53/10.*sin(11/7-20.*phi)-8/5.*sin(10/7-19.*phi)-248/13.*sin(44/43-4.*phi)-894/7.*sin(9/7-2.*phi)-1793/10.*sin(7/5-phi)+320/3.*sin(3.*phi+43/11)+761/20.*sin(5.*phi+27/8)+138/5.*sin(6.*phi+7/8)+141/4.*sin(7.*phi+32/9)+47/2.*sin(8.*phi+26/9)+114/7.*sin(9.*phi+58/13)+89/4.*sin(10.*phi+8/3)+28/5.*sin(11.*phi+12/5)+56/5.*sin(12.*phi+32/7)+51/7.*sin(13.*phi+7/2)+14/3.*sin(14.*phi+19/7)+31/3.*sin(15.*phi+17/5)+9.*sin(16.*phi+19/9)+23/6.*sin(17.*phi+26/9)+99/20.*sin(18.*phi+5/8)+58/13.*sin(21.*phi+23/5)-3861/4).*heaviside(27.*pi-phi).*heaviside(phi-23.*pi)+(-52/11.*sin(1/4-14.*phi)+1783/5.*sin(phi+34/9)+273/10.*sin(2.*phi+29/15)+527/6.*sin(3.*phi+25/7)+16/3.*sin(4.*phi+15/8)+141/8.*sin(5.*phi+32/7)+161/6.*sin(6.*phi+3)+393/8.*sin(7.*phi+6/5)+15.*sin(8.*phi+11/10)+159/8.*sin(9.*phi+41/9)+4.*sin(10.*phi+17/7)+21/4.*sin(11.*phi+37/9)+69/11.*sin(12.*phi+11/3)+7.*sin(13.*phi+16/11)-2811/5).*heaviside(23.*pi-phi).*heaviside(phi-19.*pi)+(-143/6.*sin(6/11-2.*phi)-2663/6.*sin(3/4-phi)+78.*sin(3.*phi+13/7)+545/13.*sin(4.*phi+33/8)+501/11.*sin(5.*phi+16/7)+40/9.*sin(6.*phi+39/19)+83/6.*sin(7.*phi+14/5)+83/8.*sin(8.*phi+19/8)+6/5.*sin(9.*phi+18/19)+43/6.*sin(10.*phi+50/17)+115/19.*sin(11.*phi+13/8)+9/10.*sin(12.*phi+15/4)+11/8.*sin(13.*phi+22/9)+25/13.*sin(14.*phi+7/9)+31/9.*sin(15.*phi+49/11)-488/9).*heaviside(19.*pi-phi).*heaviside(phi-15.*pi)+(-7/4.*sin(5/8-22.*phi)-30/7.*sin(7/6-21.*phi)-43/6.*sin(3/8-17.*phi)-13/4.*sin(5/6-13.*phi)-115/8.*sin(2/7-9.*phi)-2517/37.*sin(3/4-3.*phi)+3533/10.*sin(phi+31/10)+1015/6.*sin(2.*phi+1/2)+2131/26.*sin(4.*phi+68/15)+91.*sin(5.*phi+2/3)+265/9.*sin(6.*phi+17/10)+307/5.*sin(7.*phi+8/3)+44/3.*sin(8.*phi+4/5)+51/5.*sin(10.*phi+15/11)+37/4.*sin(11.*phi+12/7)+133/8.*sin(12.*phi+13/6)+27/2.*sin(14.*phi+9/4)+45/7.*sin(15.*phi+1/7)+19/4.*sin(16.*phi+67/22)+61/15.*sin(18.*phi+5/7)+11/4.*sin(19.*phi+23/8)+5/9.*sin(20.*phi+27/10)+8/5.*sin(23.*phi+17/6)+2.*sin(24.*phi+8/5)+6719/8).*heaviside(15.*pi-phi).*heaviside(phi-11.*pi)+(-89/8.*sin(10/11-14.*phi)-227/19.*sin(4/3-13.*phi)-123/13.*sin(1/3-9.*phi)-130/7.*sin(4/7-6.*phi)-22.*sin(23/22-4.*phi)-603/7.*sin(13/9-2.*phi)+458/7.*sin(phi+3/7)+362/7.*sin(3.*phi+19/7)+143/4.*sin(5.*phi+12/5)+77/8.*sin(7.*phi+11/7)+20/3.*sin(8.*phi+5/4)+184/7.*sin(10.*phi+4)+215/7.*sin(11.*phi+10/3)+68/15.*sin(12.*phi+8/3)+3513/5).*heaviside(11.*pi-phi).*heaviside(phi-7.*pi)+(-21/4.*sin(5/7-11.*phi)-5.*sin(7/10-10.*phi)-108/7.*sin(5/7-8.*phi)-111/4.*sin(3/11-4.*phi)-592/13.*sin(5/7-2.*phi)+363/4.*sin(phi+3/4)+83/3.*sin(3.*phi+16/9)+301/10.*sin(5.*phi+20/9)+199/6.*sin(6.*phi+3/4)+91/3.*sin(7.*phi+4/9)+51/7.*sin(9.*phi+11/4)+25/3.*sin(12.*phi+23/10)+34/3.*sin(13.*phi+29/8)+9419/12).*heaviside(7.*pi-phi).*heaviside(phi-3.*pi)+(-22/7.*sin(5/11-44.*phi)-119/9.*sin(4/7-41.*phi)-95/7.*sin(3/8-36.*phi)-550/29.*sin(5/4-32.*phi)-23/2.*sin(1/2-31.*phi)-223/14.*sin(20/13-29.*phi)-471/8.*sin(5/9-22.*phi)-655/16.*sin(1/4-21.*phi)-81/4.*sin(1/3-20.*phi)-319/10.*sin(2/3-18.*phi)-127/7.*sin(1/2-14.*phi)-119/5.*sin(14/9-12.*phi)-131/5.*sin(1/6-10.*phi)-136/7.*sin(3/2-9.*phi)-542/7.*sin(5/8-6.*phi)-1031/6.*sin(13/14-3.*phi)+2493/11.*sin(phi+5/7)+1814/9.*sin(2.*phi+58/19)+265/2.*sin(4.*phi+4/3)+778/7.*sin(5.*phi+7/2)+553/13.*sin(7.*phi+10/7)+94/5.*sin(8.*phi+25/6)+81/4.*sin(11.*phi+15/8)+67/3.*sin(13.*phi+3/2)+235/7.*sin(15.*phi+43/21)+72/7.*sin(16.*phi+13/5)+217/8.*sin(17.*phi+11/9)+134/7.*sin(19.*phi+35/9)+467/13.*sin(23.*phi+25/6)+94/7.*sin(24.*phi+9/8)+106/15.*sin(25.*phi+17/11)+29/2.*sin(26.*phi+18/7)+116/7.*sin(27.*phi+29/8)+66/7.*sin(28.*phi+37/10)+47/10.*sin(30.*phi+7/4)+70/9.*sin(33.*phi+25/12)+39/2.*sin(34.*phi+19/5)+67/5.*sin(35.*phi+4)+257/16.*sin(37.*phi+2/9)+103/6.*sin(38.*phi+1/2)+57/4.*sin(39.*phi+23/6)+34/5.*sin(40.*phi+51/11)+86/9.*sin(42.*phi+15/8)+183/13.*sin(43.*phi+1)+4273/6).*heaviside(3.*pi-phi).*heaviside(phi+pi)).*heaviside(sqrt(sign(sin(phi/2))));
        
        zerosmask = xx==0 & yy==0;
        xx(zerosmask) = NaN;
        yy(zerosmask) = NaN;
        
        % scale output to fill the interval [-1, 1]
        xx =  (xx + 128) ./ 1876;
        yy = -(yy + 540) ./ 1876;
    otherwise
        error('Unknown sex: %s',inputs.sex);
end
end

function y = heaviside(x)
    y = double(x >= 1);
end


%--------------------------------------------------------------------------%
% musoid.m                                                                 %
% Copyright © 2016 Vidrio Technologies, LLC                                %
%                                                                          %
% ScanImage 2016 is premium software to be used under the purchased terms  %
% Code may be modified, but not redistributed without the permission       %
% of Vidrio Technologies, LLC                                              %
%--------------------------------------------------------------------------%
