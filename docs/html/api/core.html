
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Core Functions &#8212; caiman_matlab  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=362ab14a" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinxcontrib-images/LightBox2/lightbox2/dist/css/lightbox.css?v=5c84f910" />
    <link rel="stylesheet" type="text/css" href="../_static/caiman_matlab.css?v=8c8b7c0d" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/sphinxcontrib-images/LightBox2/lightbox2/dist/js/lightbox-plus-jquery.min.js?v=ffc8af2d"></script>
    <script src="../_static/sphinxcontrib-images/LightBox2/lightbox2-customize/jquery-noconflict.js?v=12818e64"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'api/core';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Utils" href="utils.html" />
    <link rel="prev" title="API" href="index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/favicon.ico" class="logo__image only-light" alt="caiman_matlab  documentation - Home"/>
    <script>document.write(`<img src="../_static/favicon.ico" class="logo__image only-dark" alt="caiman_matlab  documentation - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../get_started/index.html">
                        First Steps
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../user_guide/index.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="index.html">
                        API
                      </a>
                    </li>
                

                <li class="nav-item">
                  <a class="nav-link nav-external" href="https://mbo.rockefeller.edu">
                    MBO
                  </a>
                </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../get_started/index.html">
                        First Steps
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../user_guide/index.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="index.html">
                        API
                      </a>
                    </li>
                

                <li class="nav-item">
                  <a class="nav-link nav-external" href="https://mbo.rockefeller.edu">
                    MBO
                  </a>
                </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Core Functions:</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Core Functions</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="utils.html">Utils</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">API</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Core Functions</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="core-functions">
<span id="core"></span><h1>Core Functions<a class="headerlink" href="#core-functions" title="Link to this heading">#</a></h1>
<dl class="mat function">
<dt class="sig sig-object mat" id="convertScanImageTiffToVolume">
<span class="sig-name descname"><span class="pre">convertScanImageTiffToVolume</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">data_path</span></em>, <em class="sig-param"><span class="pre">save_path</span></em>, <em class="sig-param"><span class="pre">varargin</span></em><span class="sig-paren">)</span><a class="headerlink" href="#convertScanImageTiffToVolume" title="Link to this definition">#</a></dt>
<dd><p>convertScanImageTiffToVolume Convert ScanImage .tif files into a 4D volume.</p>
<p>Convert raw <a class="reference external" href="https://www.mbfbioscience.com/products/scanimage/">ScanImage</a> multi-roi .tif files from a single session
into a single 4D volumetric time-series (x, y, z, t). It’s designed to process files for the
ScanImage Version: 2016 software.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data_path</strong><span class="classifier">char</span></dt><dd><p>The directory containing the raw .tif files. Only raw .tif files from one
session should be in the directory.</p>
</dd>
<dt><strong>save_path</strong><span class="classifier">char, optional</span></dt><dd><p>The directory where processed files will be saved. It is created if it does
not exist. Defaults to the data_path directory.</p>
</dd>
<dt><strong>dataset_name</strong><span class="classifier">string, optional</span></dt><dd><p>Name of the group (h5 dataset) to save the extracted data. Default is
‘/Y’. Must contain a leading slash.</p>
</dd>
<dt><strong>debug_flag</strong><span class="classifier">double, logical, optional</span></dt><dd><p>If set to 1, the function displays the files in the command window and does
not continue processing. Defaults to 0.</p>
</dd>
<dt><strong>overwrite</strong><span class="classifier">logical, optional</span></dt><dd><p>Whether to overwrite existing files (default is 1).</p>
</dd>
<dt><strong>fix_scan_phase</strong><span class="classifier">logical, optional</span></dt><dd><p>Whether to correct for bi-directional scan artifacts. (default is true).</p>
</dd>
<dt><strong>trim_pixels</strong><span class="classifier">double, optional</span></dt><dd><p>Pixels to trim from left, right,top, bottom of each scanfield before
horizontally concatenating the scanfields within an image. Default is
[0 0 0 0].</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The function adds necessary paths for ScanImage utilities and processes each .tif
file found in the specified directory. It checks if the directory exists, handles
multiple or single file scenarios, and can optionally report the directory’s contents
based on the debug_flag.</p>
<p>Each file processed is logged, assembled into a 4D volume, and saved in a specified
directory as a .mat file with accompanying metadata. The function also manages errors
by cleaning up and providing detailed error messages if something goes wrong during
processing.</p>
<p>See also <code class="docutils literal notranslate"><span class="pre">FILEPARTS</span></code>, <code class="docutils literal notranslate"><span class="pre">ADDPATH</span></code>, <code class="docutils literal notranslate"><span class="pre">GENPATH</span></code>, <code class="docutils literal notranslate"><span class="pre">ISFOLDER</span></code>, <code class="docutils literal notranslate"><span class="pre">DIR</span></code>, <code class="docutils literal notranslate"><span class="pre">FULLFILE</span></code>, <code class="docutils literal notranslate"><span class="pre">ERROR</span></code>, <code class="docutils literal notranslate"><span class="pre">REGEXP</span></code>, <code class="docutils literal notranslate"><span class="pre">SAVEFAST</span></code></p>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="motionCorrectPlane">
<span class="sig-name descname"><span class="pre">motionCorrectPlane</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">data_path</span></em>, <em class="sig-param"><span class="pre">save_path</span></em>, <em class="sig-param"><span class="pre">varargin</span></em><span class="sig-paren">)</span><a class="headerlink" href="#motionCorrectPlane" title="Link to this definition">#</a></dt>
<dd><p>MOTIONCORRECTPLANE Perform piecewise-rigid motion correction on imaging data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data_path</strong><span class="classifier">char</span></dt><dd><p>Path to the directory containing the files extracted via convertScanImageTiffToVolume.</p>
</dd>
<dt><strong>save_path</strong><span class="classifier">char</span></dt><dd><p>Path to the directory to save the motion vectors.</p>
</dd>
<dt><strong>dataset_name</strong><span class="classifier">string, optional</span></dt><dd><p>Group path within the hdf5 file that contains raw data.
Default is ‘registration’.</p>
</dd>
<dt><strong>debug_flag</strong><span class="classifier">double, logical, optional</span></dt><dd><p>If set to 1, the function displays the files in the command window and does
not continue processing. Defaults to 0.</p>
</dd>
<dt><strong>overwrite</strong><span class="classifier">logical, optional</span></dt><dd><p>Whether to overwrite existing files (default is 1).</p>
</dd>
<dt><strong>num_cores</strong><span class="classifier">double, integer, positive</span></dt><dd><p>Number of cores to use for computation. The value is limited to a maximum
of 24 cores.</p>
</dd>
<dt><strong>start_plane</strong><span class="classifier">double, integer, positive</span></dt><dd><p>The starting plane index for processing.</p>
</dd>
<dt><strong>end_plane</strong><span class="classifier">double, integer, positive</span></dt><dd><p>The ending plane index for processing. Must be greater than or equal to
start_plane.</p>
</dd>
<dt><strong>options</strong><span class="classifier">struct</span></dt><dd><p>NormCorre Params Object,</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>shifts</strong><span class="classifier">array</span></dt><dd><p>2D motion vectors as single precision.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Each motion-corrected plane is saved as a .h5 group containing the 2D
shift vectors in x and y</p></li>
<li><p>Only .h5 files containing processed volumes should be in the file_path.</p></li>
</ul>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="segmentPlane">
<span class="sig-name descname"><span class="pre">segmentPlane</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">data_path</span></em>, <em class="sig-param"><span class="pre">save_path</span></em>, <em class="sig-param"><span class="pre">varargin</span></em><span class="sig-paren">)</span><a class="headerlink" href="#segmentPlane" title="Link to this definition">#</a></dt>
<dd><p>SEGMENTPLANE Segment imaging data using CaImAn for motion-corrected data.</p>
<p>This function applies the CaImAn algorithm to segment neurons from
motion-corrected, pre-processed and ROI re-assembled MAxiMuM data.
The processing is conducted for specified planes, and the results
are saved to disk.</p>
<p>MOTIONCORRECTPLANE Perform rigid and non-rigid motion correction on imaging data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data_path</strong><span class="classifier">char</span></dt><dd><p>Path to the directory containing the files extracted via convertScanImageTiffToVolume.</p>
</dd>
<dt><strong>save_path</strong><span class="classifier">char</span></dt><dd><p>Path to the directory to save the motion vectors.</p>
</dd>
<dt><strong>dataset_name</strong><span class="classifier">string, optional</span></dt><dd><p>Group path within the hdf5 file that contains raw data.</p>
</dd>
<dt><strong>debug_flag</strong><span class="classifier">double, logical, optional</span></dt><dd><p>If set to 1, the function displays the files in the command window and does
not continue processing. Defaults to 0.</p>
</dd>
<dt><strong>overwrite</strong><span class="classifier">logical, optional</span></dt><dd><p>Whether to overwrite existing files (default is 1).</p>
</dd>
<dt><strong>num_cores</strong><span class="classifier">double, integer, positive</span></dt><dd><p>Number of cores to use for computation. The value is limited to a maximum
of 24 cores.</p>
</dd>
<dt><strong>start_plane</strong><span class="classifier">double, integer, positive</span></dt><dd><p>The starting plane index for processing.</p>
</dd>
<dt><strong>end_plane</strong><span class="classifier">double, integer, positive</span></dt><dd><p>The ending plane index for processing. Must be greater than or equal to
start_plane.</p>
</dd>
<dt><strong>cnmf_options</strong><span class="classifier">dictionary, mapping</span></dt><dd><p>key:value pairs of all of your CNMF parameters.
See the example parameters in the LBM_demo_pipeline.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Outputs are saved to disk, including:</p></li>
<li><p>T_keep: neuronal time series [Km, T] (single)</p></li>
<li><p>Ac_keep: neuronal footprints [2*tau+1, 2*tau+1, Km] (single)</p></li>
<li><p>C_keep: denoised time series [Km, T] (single)</p></li>
<li><p>Km: number of neurons found (single)</p></li>
<li><p>Cn: correlation image [x, y] (single)</p></li>
<li><p>b: background spatial components [x*y, 3] (single)</p></li>
<li><p>f: background temporal components [3, T] (single)</p></li>
<li><p>acx: centroid in x direction for each neuron [1, Km] (single)</p></li>
<li><p>acy: centroid in y direction for each neuron [1, Km] (single)</p></li>
<li><p>acm: sum of component pixels for each neuron [1, Km] (single)</p></li>
<li><p>The function handles large datasets by processing each plane serially.</p></li>
<li><p>The segmentation settings are based on the assumption of 9.2e4 neurons/mm^3
density in the imaged volume.</p></li>
</ul>
<p>See also <code class="docutils literal notranslate"><span class="pre">ADDPATH</span></code>, <code class="docutils literal notranslate"><span class="pre">FULLFILE</span></code>, <code class="docutils literal notranslate"><span class="pre">DIR</span></code>, <code class="docutils literal notranslate"><span class="pre">LOAD</span></code>, <code class="docutils literal notranslate"><span class="pre">SAVEFAST</span></code></p>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="collatePlanes">
<span class="sig-name descname"><span class="pre">collatePlanes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">data_path</span></em>, <em class="sig-param"><span class="pre">save_path</span></em>, <em class="sig-param"><span class="pre">varargin</span></em><span class="sig-paren">)</span><a class="headerlink" href="#collatePlanes" title="Link to this definition">#</a></dt>
<dd><p>COLLATEPLANES Analyzes and processes imaging data by extracting and correcting features across multiple planes.</p>
<p>This function analyzes imaging data from a specified directory, applying
various thresholds and corrections based on metadata. It processes neuron
activity data, handles z-plane corrections, and outputs figures representing
neuron distributions along with collated data files.</p>
<p>The function expects the directory to contain ‘caiman_output_plane_*.mat’ files
with variables related to neuronal activity, and uses provided metadata for
processing parameters. It adjusts parameters dynamically based on the content
of metadata and filters, merges data across imaging planes, and performs
z-plane and field curvature corrections.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data_path</strong><span class="classifier">string</span></dt><dd><p>Path to the directory containing the image data and calibration files.
The function expects to find ‘pollen_sample_xy_calibration.mat’ in this directory along with each caiman_output_plane_N.</p>
</dd>
<dt><strong>save_path</strong><span class="classifier">char</span></dt><dd><p>Path to the directory to save the motion vectors.</p>
</dd>
<dt><strong>dataset_name</strong><span class="classifier">string, optional</span></dt><dd><p>Group path within the hdf5 file that contains raw data.
Default is ‘registration’.</p>
</dd>
<dt><strong>debug_flag</strong><span class="classifier">double, logical, optional</span></dt><dd><p>If set to 1, the function displays the files in the command window and does
not continue processing. Defaults to 0.</p>
</dd>
<dt><strong>overwrite</strong><span class="classifier">logical, optional</span></dt><dd><p>Whether to overwrite existing files (default is 1).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>offsets</strong><span class="classifier">Nx2 array</span></dt><dd><p>An array of offsets between consecutive planes, where N is the number
of planes processed. Each row corresponds to a plane, and the two columns
represent the calculated offset in pixels along the x and y directions,
respectively.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>This function requires calibration data in input datapath:
- pollen_sample_xy_calibration.mat</p></li>
<li><p>The function uses MATLAB’s <cite>ginput</cite> function for manual feature selection
on the images. It expects the user to manually select the corresponding
points on each plane.</p></li>
<li><p>The function assumes that the consecutive images will have some overlap
and that features will be manually identifiable and trackable across planes.</p></li>
</ul>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="calculateZOffset">
<span class="sig-name descname"><span class="pre">calculateZOffset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">data_path</span></em>, <em class="sig-param"><span class="pre">save_path</span></em>, <em class="sig-param"><span class="pre">varargin</span></em><span class="sig-paren">)</span><a class="headerlink" href="#calculateZOffset" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data_path</strong><span class="classifier">string</span></dt><dd><p>Path to the directory containing the image data and calibration files.
The function expects to find ‘pollen_sample_xy_calibration.mat’ in this directory along with each caiman_output_plane_N.</p>
</dd>
<dt><strong>save_path</strong><span class="classifier">char</span></dt><dd><p>Path to the directory to save the motion vectors.</p>
</dd>
<dt><strong>dataset_name</strong><span class="classifier">string, optional</span></dt><dd><p>Group path within the hdf5 file that contains raw data.
Default is ‘registration’.</p>
</dd>
<dt><strong>debug_flag</strong><span class="classifier">double, logical, optional</span></dt><dd><p>If set to 1, the function displays the files in the command window and does
not continue processing. Defaults to 0.</p>
</dd>
<dt><strong>overwrite</strong><span class="classifier">logical, optional</span></dt><dd><p>Whether to overwrite existing files (default is 1).</p>
</dd>
<dt><strong>num_cores</strong><span class="classifier">double, integer, positive</span></dt><dd><p>Number of cores to use for computation. The value is limited to a maximum
of 24 cores.</p>
</dd>
<dt><strong>start_plane</strong><span class="classifier">double, integer, positive</span></dt><dd><p>The starting plane index for processing.</p>
</dd>
<dt><strong>end_plane</strong><span class="classifier">double, integer, positive</span></dt><dd><p>The ending plane index for processing. Must be greater than or equal to
start_plane.</p>
</dd>
<dt><strong>num_features</strong><span class="classifier">double, integer, positive</span></dt><dd><p>The number of features to identify and use in each plane for
calculating offsets. Default is 3 features/neurons compared across
z-plane/z-plane+1.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>offsets</strong><span class="classifier">Nx2 array</span></dt><dd><p>An array of offsets between consecutive planes, where N is the number
of planes processed. Each row corresponds to a plane, and the two columns
represent the calculated offset in pixels along the x and y directions,
respectively.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>This function requires calibration data in input datapath:
- pollen_sample_xy_calibration.mat</p></li>
<li><p>The function uses MATLAB’s <cite>ginput</cite> function for manual feature selection
on the images. It expects the user to manually select the corresponding
points on each plane.</p></li>
<li><p>The function assumes that the consecutive images will have some overlap
and that features will be manually identifiable and trackable across planes.</p></li>
</ul>
</dd></dl>

</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">API</p>
      </div>
    </a>
    <a class="right-next"
       href="utils.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Utils</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../_sources/api/core.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, Elizabeth R. Miller Brain Observatory (MBO) | The Rockefeller University. All Rights Reserved..
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.2.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>